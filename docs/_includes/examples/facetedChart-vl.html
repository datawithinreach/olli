<!DOCTYPE html>

<head>
  {% include imports.html %}
</head>

<body>
  <div class="Code-Block">
    <code class="prettyprint">
    let spec = { ... }

    let vegaSpec = vegaLite.compile(spec).spec
    const runtime = vega.parse(vegaSpec);
    const vegaRender = document.getElementById('Visualization-Vega-Lite');
    let view = new vega.View(runtime)
      .logLevel(vega.Warn)
      .initialize(vegaRender)
      .renderer('svg')
      .hover()
      .run();
  
    olli({ 
      visualization: VegaLiteAdapter(view, spec),
      renderType: "tree", 
      domId: "AccessibilityTree-Vega-Lite"
    })
    </code>
  </div>
  <script type="module">
    let spec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "name": "trellis_barley",
      "description": "A small multiples view of barley yields by site and variety.",
      "data": { "url": "https://raw.githubusercontent.com/vega/vega-datasets/next/data/barley.json" },
      "mark": "point",
      "height": { "step": 12 },
      "encoding": {
        "facet": {
          "field": "site",
          "type": "ordinal",
          "columns": 2,
          "sort": { "op": "median", "field": "yield" }
        },
        "x": {
          "aggregate": "median",
          "field": "yield",
          "type": "quantitative",
          "scale": { "zero": false }
        },
        "y": {
          "field": "variety",
          "type": "ordinal",
          "sort": "-x"
        },
        "color": { "field": "year", "type": "nominal" }
      }
    }


    let vegaSpec = vegaLite.compile(spec).spec
    const runtime = vega.parse(vegaSpec);
    const vegaRender = document.getElementById('Visualization-Vega-Lite');
    let view = new vega.View(runtime)
      .logLevel(vega.Warn)
      .initialize(vegaRender)
      .renderer('svg')
      .hover()
      .runAsync()
      .then(v => {
        olli({
          visualization: OlliAdapters.VegaLiteAdapter(v.scenegraph().root.items[0], spec),
          renderType: "tree",
          domId: "AccessibilityTree-Vega-Lite"
        })
      });
  </script>
</body>